<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>My Free Website</title>
  <link rel="stylesheet" href="styles.css" />
</head>
<body>

  <!-- 🌐 Header -->
  <header class="header">
  <div class="container header-container">
    <!-- Hamburger Icon -->
    <div class="hamburger">
      <span></span>
      <span></span>
      <span></span>
    </div>

    <!-- Logo -->
    <a href="index.html" class="logo">DjsDopeDesigns</a>

    <!-- Search Bar -->
    <input type="text" class="search-bar" placeholder="Search products...">

    <!-- Heart / Liked Items -->
    <a href="liked.html" class="liked-items">♥</a>

    <!-- Shopping Cart Icon -->
    <a href="cart.html" class="cart">
      <img src="images/cart-icon.png" alt="Cart">
    </a>
  </div>
</header>

  <!-- 🛍 Product Grid -->
  <section class="products">
    <div class="container">
      <div class="cards" id="product-grid">
        <!-- JS will populate products here -->
      </div>
    </div>
  </section>

  <!-- 🦶 Footer -->
  <footer class="footer">
    <div class="container">
      <p>&copy; 2025 MyShop. All rights reserved.</p>
    </div>
  </footer>

<script>
  // Fetch products.json and dynamically create product cards
  fetch('products.json')
    .then(res => res.json())
    .then(products => {
      const grid = document.getElementById('product-grid');
      products.forEach(product => {
        const card = document.createElement('div');
        card.className = 'card';
        card.innerHTML = `
          <div class="heart" onclick="toggleLike(${product.id}, this)">♡</div>
          <a href="product.html?id=${product.id}">
            <img src="${product.image}" alt="${product.name}">
            <h3>${product.name}</h3>
          </a>
          <p>$${(product.price / 100).toFixed(2)}</p>
          <button class="btn" onclick="addToCart(${product.id})">Add to Cart</button>
        `;
        grid.appendChild(card);
      });

      // Restore liked hearts
      restoreLikedHearts();
    })
    .catch(err => console.error("Failed to load products:", err));

  // Add to Cart
  function addToCart(productId) {
    fetch('products.json')
      .then(res => res.json())
      .then(products => {
        const product = products.find(p => p.id === productId);
        if (!product) return;
        let cart = JSON.parse(localStorage.getItem("cart")) || [];
        const existing = cart.find(item => item.id === productId);
        if (existing) {
          existing.quantity++;
        } else {
          cart.push({ id: product.id, name: product.name, price: product.price, quantity: 1 });
        }
        localStorage.setItem("cart", JSON.stringify(cart));
        updateCartCount(); // update live cart counter
        alert(`${product.name} added to cart!`);
      });
  }

  // Heart toggle
  function toggleLike(productId, el) {
    productId = productId.toString();
    let liked = JSON.parse(localStorage.getItem("likedItems")) || [];
    if (liked.includes(productId)) {
      liked = liked.filter(id => id !== productId);
      el.textContent = "♡";
    } else {
      liked.push(productId);
      el.textContent = "♥";
    }
    localStorage.setItem("likedItems", JSON.stringify(liked));
  }

  // Restore liked hearts
  function restoreLikedHearts() {
    let liked = JSON.parse(localStorage.getItem("likedItems")) || [];
    document.querySelectorAll(".card").forEach(card => {
      const heart = card.querySelector(".heart");
      const productLink = card.querySelector("a");
      if (!productLink || !heart) return;
      const url = new URL(productLink.href, window.location.href);
      const id = url.searchParams.get("id");
      if (liked.includes(id)) {
        heart.textContent = "♥";
      }
    });
  }

  // Update live cart count
  function updateCartCount() {
    const cart = JSON.parse(localStorage.getItem("cart")) || [];
    const total = cart.reduce((sum, item) => sum + item.quantity, 0);
    const counter = document.getElementById("cart-count");
    if (counter) counter.textContent = total;
  }

  // Initialize cart counter on page load
  updateCartCount();
</script>

</body>
</html>
